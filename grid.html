<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Grid View</title>
  <style>
    body {
      margin: 0;
      height: 100vh;
      background-image: url('https://images.unsplash.com/photo-1601134467661-3d775b999c8b?auto=format&fit=crop&q=80&w=1975');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      overflow: hidden;
      font-family: monospace;
      color: #00ffcc;
    }

    #cluster-container {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 420px;
      height: 420px;
      z-index: 5;
    }

    svg {
      width: 100%;
      height: 100%;
    }

    .node {
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { r: 6; opacity: 1; }
      50%      { r: 9; opacity: 0.6; }
    }

    .branch {
      stroke: #00ffcc;
      stroke-width: 2.5;
      fill: none;
      stroke-dasharray: 100;
      animation: flowBranch 4s linear infinite;
    }

    @keyframes flowBranch {
      to { stroke-dashoffset: -100; }
    }

    .live-button {
      position: fixed;
      bottom: 20px;
      right: 20px;
      padding: 12px 24px;
      background: #00ffcc;
      color: #000;
      border: none;
      font-weight: bold;
      cursor: pointer;
      border-radius: 6px;
      box-shadow: 0 0 12px #00ffcc;
      z-index: 100;
    }

    .live-button:hover {
      background: #00ffaa;
    }

    #python-section {
      position: fixed;
      top: 16px;
      left: 16px;
      background: rgba(0,0,0,0.65);
      padding: 12px 16px;
      border: 1px solid #00ffcc;
      border-radius: 6px;
      box-shadow: 0 0 16px #00ffcc88;
      z-index: 50;
      max-width: 340px;
    }

    #python-code {
      width: 300px;
      height: 140px;
      background: #0a0a0a;
      color: #00ffcc;
      border: 1px solid #00ffcc;
      padding: 8px;
      font-family: monospace;
      resize: vertical;
    }

    #rtx-image {
      position: fixed;
      bottom: 100px;
      left: 50%;
      transform: translateX(-50%);
      width: 180px;
      border: 2px solid #00ffcc;
      box-shadow: 0 0 24px #00ffcc;
      filter: drop-shadow(0 0 16px #00ffcc);
      z-index: 20;
      cursor: pointer;
      transition: transform 0.2s;
    }

    #rtx-image:hover {
      transform: translateX(-50%) scale(1.1);
    }

    #bolt {
      position: fixed;
      width: 80px;
      height: 80px;
      pointer-events: none;
      transform: translate(-50%, -50%);
      display: none;
      z-index: 30;
      opacity: 0.9;
    }

    #bolt.active {
      animation: boltPulse 0.3s infinite;
    }

    @keyframes boltPulse {
      0%, 100% { transform: translate(-50%, -50%) scale(1) rotate(0deg); opacity: 0.95; }
      50%      { transform: translate(-50%, -50%) scale(1.25) rotate(10deg); opacity: 1; }
    }

    #phase-image {
      position: fixed;
      top: 20px;
      right: 20px;
      width: 220px;
      border: 2px solid #00ffcc;
      box-shadow: 0 0 16px #00ffcc;
      display: none;
      z-index: 10;
    }
  </style>
</head>
<body>

  <div id="cluster-container">
    <svg viewBox="0 0 420 420">
      <line class="branch" x1="210" y1="210" x2="110" y2="110"/>
      <line class="branch" x1="210" y1="210" x2="310" y2="110"/>
      <line class="branch" x1="210" y1="210" x2="140" y2="320"/>
      <line class="branch" x1="210" y1="210" x2="310" y2="320"/>
      <line class="branch" x1="210" y1="210" x2="210" y2="370"/>
      <circle class="node" cx="210" cy="210" r="6" fill="#00ffcc"/>
      <circle class="node" cx="110" cy="110" r="6" fill="#00ffcc"/>
      <circle class="node" cx="310" cy="110" r="6" fill="#00ffcc"/>
      <circle class="node" cx="140" cy="320" r="6" fill="#00ffcc"/>
      <circle class="node" cx="310" cy="320" r="6" fill="#00ffcc"/>
      <circle class="node" cx="210" cy="370" r="6" fill="#00ffcc"/>
      <text x="100" y="95"  fill="#00ffcc" font-size="13">Symbol_0</text>
      <text x="320" y="95"  fill="#00ffcc" font-size="13">Symbol_1</text>
      <text x="120" y="340" fill="#00ffcc" font-size="13">Symbol_2</text>
      <text x="320" y="340" fill="#00ffcc" font-size="13">Symbol_3</text>
      <text x="220" y="390" fill="#00ffcc" font-size="13">Rx</text>
    </svg>
  </div>

  <!-- Lightning follows mouse over RTX -->
  <img id="bolt" src="https://www.vhv.rs/dpng/d/514-5149701_red-lightening-bolt-png-icons-circle-lightning-bolt.png" alt="⚡">

  <!-- Centered NVIDIA RTX image -->
  <img id="rtx-image"
       src="https://m.media-amazon.com/images/I/512T3hTT5ZL.jpg"
       alt="NVIDIA RTX Graphics Card">

  <button class="live-button" onclick="window.open('https://satellitemap.space', '_blank')">
    Live Satellite Map
  </button>

  <section id="python-section">
    <h3>Python Code (simulated)</h3>
    <textarea id="python-code" placeholder="Enter Python here... (ICEPICK to unlock)"></textarea>
  </section>

  <!-- Restored original-style NOAA Ian rainfall image -->
  <img id="phase-image"
       src="https://www.ncei.noaa.gov/monitoring-content/sotc/national/2022/sep/ian/prcp-total-2022-0927-0930.png"
       alt="NOAA Hurricane Ian Rainfall">

<script>
// Python-like functions (unchanged)
const $pythonFunctions = {
  antiVUCurve(iterations, decay = 1) {
    const symbols = [];
    for (let r = 0; r < iterations; r++) {
      const value = Math.log(r + 1) * decay;
      symbols.push({ id: `Symbol_${r}`, value: +value.toFixed(2) });
    }
    return symbols;
  },
  clusterGenerate(subject, count) {
    return `$${subject}_cluster_${count}`;
  }
};

// PHI rewrite on input
function phiRewrite(input, phase = 1) {
  let arr = typeof input === "string" ? [...input].map(c => c.charCodeAt(0)) : input;
  if (!Array.isArray(arr)) return null;
  const PHI = (1 + Math.sqrt(5)) / 2;
  return arr.map((v, i) => Number((v * PHI + phase * (i + 1)).toFixed(3)));
}

let WALRUS_UNLOCKED = false;

const $ = (id) => {
  if (!WALRUS_UNLOCKED) {
    console.warn("Walrus locked. Type ICEPICK");
    return null;
  }
  return document.getElementById(id);
};

function phaseFunction() {
  const img = document.getElementById("phase-image");
  if (img) img.style.display = "block";
  console.log("%cPHASE-1 ACTIVATED", "color:#0f0;font-weight:bold");
}

function startVibrationPortal() {
  const box = document.getElementById("python-code");
  if (!box) return;
  const frames = ["~ ~ ~ ~ ~", " ~ ~ ~ ~ ", "~ ~ ~ ~ ~", " ~ ~ ~ ~ "];
  let i = 0;
  const iv = setInterval(() => {
    box.value = frames[i++ % frames.length];
  }, 220);
  setTimeout(() => clearInterval(iv), 8000); // stop after ~8s
}

// Unlock & effects
document.getElementById("python-code")?.addEventListener("input", function() {
  const val = this.value.trim();
  console.log("PHI →", phiRewrite(val));

  if (val.toUpperCase() === "ICEPICK") {
    WALRUS_UNLOCKED = true;
    console.log("%cWALRUS UNLOCKED", "color:#0f0;font-weight:bold");
    phaseFunction();
    startVibrationPortal();
  }
});

// Lightning pointer subsystem – now fully validated
function attachLightning() {
  const rtx = document.getElementById("rtx-image");
  const bolt = document.getElementById("bolt");
  if (!rtx || !bolt) return;

  rtx.addEventListener("mouseenter", () => {
    bolt.style.display = "block";
    bolt.classList.add("active");
  });

  rtx.addEventListener("mousemove", e => {
    bolt.style.left = e.clientX + "px";
    bolt.style.top  = e.clientY + "px";
  });

  rtx.addEventListener("mouseleave", () => {
    bolt.style.display = "none";
    bolt.classList.remove("active");
  });
}

document.addEventListener("DOMContentLoaded", () => {
  attachLightning();
  console.log("Cluster:", $pythonFunctions.clusterGenerate("quantum", 7));
});
</script>
</body>
</html>
