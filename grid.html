<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Grid View</title>
  <style>
    body {
      margin: 0;
      height: 100vh;
      background-image: url('https://www.gannett-cdn.com/presto/2022/10/05/USAT/98e8113e-799e-4b49-9f74-65fb63733961-Ian_rainfall.jpg?width=1320&height=744&fit=crop&format=pjpg&auto=webp');
      background-size: cover;
      background-position: center;
      display: grid;
      place-items: center;
      position: relative;
    }
    img {
      max-width: 90%;
      height: auto;
      border: 2px solid #00ffcc;
      box-shadow: 0 0 20px #00ffcc;
      opacity: 0.75;
    }
    .live-button {
      position: absolute;
      bottom: 20px;
      right: 20px;
      padding: 10px 20px;
      background-color: #00ffcc;
      color: #000;
      border: none;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 0 10px #00ffcc;
    }
    .live-button:hover {
      background-color: #00ffaa;
    }
    #cluster-container {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 400px;
      height: 400px;
    }
    svg {
      width: 100%;
      height: 100%;
    }
    .node {
      animation: pulse 2s infinite;
    }
    @keyframes pulse {
      0%, 100% { r: 6px; opacity: 1; }
      50% { r: 8px; opacity: 0.7; }
    }
    .branch {
      stroke: #00ffcc;
      stroke-width: 2;
      fill: none;
      animation: flowBranch 3s infinite;
    }
    @keyframes flowBranch {
      0% { stroke-dashoffset: 100; }
      100% { stroke-dashoffset: 0; }
    }

    /* Python window styling */
    #python-section {
      position: absolute;
      top: 20px;
      left: 20px;
      background: rgba(0,0,0,0.6);
      padding: 10px;
      border: 1px solid #00ffcc;
      box-shadow: 0 0 10px #00ffcc;
      color: #00ffcc;
    }
    #python-code {
      width: 300px;
      height: 150px;
      background: #111;
      color: #00ffcc;
      border: 1px solid #00ffcc;
      padding: 5px;
      resize: none;
    }
  </style>
</head>

<body>

  <!-- Symbol Cluster -->
  <div id="cluster-container">
    <svg viewBox="0 0 400 400">
      <line class="branch" x1="200" y1="200" x2="100" y2="100" stroke-dasharray="100"/>
      <line class="branch" x1="200" y1="200" x2="300" y2="100" stroke-dasharray="100"/>
      <line class="branch" x1="200" y1="200" x2="150" y2="300" stroke-dasharray="100"/>
      <line class="branch" x1="200" y1="200" x2="300" y2="300" stroke-dasharray="100"/>
      <line class="branch" x1="200" y1="200" x2="200" y2="350" stroke-dasharray="100"/>

      <circle class="node" cx="200" cy="200" r="6" fill="#00ffcc"/>
      <circle class="node" cx="100" cy="100" r="6" fill="#00ffcc"/>
      <circle class="node" cx="300" cy="100" r="6" fill="#00ffcc"/>
      <circle class="node" cx="150" cy="300" r="6" fill="#00ffcc"/>
      <circle class="node" cx="300" cy="300" r="6" fill="#00ffcc"/>
      <circle class="node" cx="200" cy="350" r="6" fill="#00ffcc"/>

      <text x="100" y="85" fill="#00ffcc" font-size="12">Symbol_0</text>
      <text x="300" y="85" fill="#00ffcc" font-size="12">Symbol_1</text>
      <text x="130" y="320" fill="#00ffcc" font-size="12">Symbol_2</text>
      <text x="310" y="320" fill="#00ffcc" font-size="12">Symbol_3</text>
      <text x="210" y="370" fill="#00ffcc" font-size="12">Rx</text>
    </svg>
  </div>

  <!-- RTX Image -->
  <img src="https://tse3.mm.bing.net/th/id/OIP.oOyGsr3RTqdhDm-XAABYCwHaFc?r=0&rs=1&pid=ImgDetMain&o=7&rm=3" alt="RTX Graphics Card">

  <!-- Live Satellite Button -->
  <button class="live-button" onclick="window.open('https://satellitemap.space', '_blank')">
    View Live Satellite Map
  </button>

  <!-- Python Code Window -->
  <section id="python-section">
    <h3>Python Code Entry Window</h3>
    <textarea id="python-code" placeholder="Enter your Python code here..."
      oninput="this.value = this.value.slice(0, 1024);"
      title="Only Python syntax is accepted. Code will not be executed."></textarea>
  </section>

  <img id="phase-image" 
     src="https://th.bing.com/th/id/OIP.P1wSCrlDsNOMimDn39bkPgHaFX?w=246&h=180&c=7&r=0&o=7&dpr=1.5&pid=1.7&rm=3"
     style="display:none; position:absolute; top:20px; right:20px; width:200px; border:2px solid #00ffcc; box-shadow:0 0 10px #00ffcc;">
<script>
/* ---------------------------
   PYTHON FUNCTIONS (unchanged)
---------------------------- */
window.$pythonFunctions = {
  antiVUCurve: function(iterations, decay = 1) {
    let symbols = [];
    for (let r = 0; r < iterations; r++) {
      let value = Math.log(r + 1) * decay;
      symbols.push({
        id: `Symbol_${r}`,
        value: parseFloat(value.toFixed(2)),
        uniqueId: `${r}_${Math.random().toString(36).substr(2, 9)}`
      });
    }
    return symbols;
  },

  clusterGenerate: function(subject, count) {
    return `$${subject}_cluster_${count}`;
  },

  nodePosition: function(index, radius = 150, centerX = 200, centerY = 200) {
    let angle = (index / 6) * Math.PI * 2;
    return {
      x: centerX + radius * Math.cos(angle),
      y: centerY + radius * Math.sin(angle)
    };
  },

  execute: function(fnName, ...args) {
    if (typeof this[fnName] === 'function') {
      return this[fnName](...args);
    }
    return `Function ${fnName} not found`;
  }
};

/* ============================================================
   PHI REWRITE DATA SIGNAL SUBSYSTEM
============================================================ */
function phiRewrite(input, phase = 1) {
  let arr = [];

  if (typeof input === "string") {
    arr = input.split("").map(ch => ch.charCodeAt(0));
  } else if (Array.isArray(input)) {
    arr = input;
  } else {
    return null;
  }

  const PHI = (1 + Math.sqrt(5)) / 2;

  return arr.map((v, i) => {
    const shifted = v * PHI;
    const biased = shifted + phase * (i + 1);
    return Number(biased.toFixed(3));
  });
}

function attachPhiToPythonWindow() {
  const pyBox = document.getElementById("python-code");
  if (!pyBox) return;

  pyBox.addEventListener("input", () => {
    const raw = pyBox.value;
    const phiSignal = phiRewrite(raw, 1);
    console.log("PHI SIGNAL:", phiSignal);
  });
}

document.addEventListener("DOMContentLoaded", attachPhiToPythonWindow);

/* ---------------------------
   WALRUS LOCK SYSTEM
---------------------------- */
let WALRUS_UNLOCKED = false;

/* gated walrus operator */
const $ = (eid) => {
  if (!WALRUS_UNLOCKED) {
    console.warn("Walrus operator locked. Type ICEPICK in the Python window.");
    return null;
  }
  return document.getElementById(eid);
};

/* ---------------------------
   PHASE FUNCTION
---------------------------- */
function phaseFunction() {
  const img = document.getElementById("phase-image");
  img.style.display = "block";

  console.log("%cPHASE-1 ACTIVATED", "color:#00ffcc;font-weight:bold;");

  const symbols = window.$pythonFunctions.antiVUCurve(3);
  console.log("Phase Symbols:", symbols);
}

/* ---------------------------
   PYTHON WINDOW UNLOCK LISTENER
---------------------------- */
document.getElementById("python-code").addEventListener("input", function() {
  const text = this.value.trim();

  if (text === "ICEPICK") {
    WALRUS_UNLOCKED = true;
    console.log("%cWALRUS OPERATOR UNLOCKED", "color:#00ffcc;font-weight:bold;");
    phaseFunction();
    startVibrationPortal();
  }
});

/* ---------------------------
   RUN SEQUENCE
---------------------------- */
function runSequence() {
  console.log("%cRUN SEQUENCE INITIATED", "color:#00ffcc;font-weight:bold;");

  const img = document.getElementById("phase-image");
  img.style.transition = "transform 1.5s ease-out";
  img.style.transform = "scale(1.2) rotate(3deg)";

  const symbols = window.$pythonFunctions.antiVUCurve(6);
  console.log("RUN Sequence Symbols:", symbols);

  document.body.style.transition = "background-color 1s";
  document.body.style.backgroundColor = "rgba(0, 255, 204, 0.15)";
  setTimeout(() => {
    document.body.style.backgroundColor = "";
  }, 1200);
}

/* ---------------------------
   VIBRATION PORTAL
---------------------------- */
function vibrationPattern() {
  const frames = [
    "~ ~ ~ ~ ~",
    " ~ ~ ~ ~ ",
    "~ ~ ~ ~ ~",
    " ~ ~ ~ ~ ",
  ];
  return frames;
}

function startVibrationPortal() {
  const box = document.getElementById("python-code");
  const frames = vibrationPattern();
  let i = 0;

  setInterval(() => {
    box.value = frames[i % frames.length];
    i++;
  }, 180);
}

/* ---------------------------
   TIMESTAMP LOGIC (unchanged)
---------------------------- */
const now = Date.now();
const lastPing = localStorage.getItem('lastPing') || 0;
const twelveHours = 12 * 60 * 60 * 1000;

if (now - lastPing > twelveHours) {
  localStorage.setItem('lastPing', now);
}

console.log('Cluster Generated:', window.$pythonFunctions.clusterGenerate('fastener', 5));
</script>
</body>
</html>
